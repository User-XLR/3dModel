# 模型注释功能使用说明

## 功能概述

新增的模型注释功能允许用户在 3D 场景中为模型部位添加注释指示牌，用于标记和说明特定的模型部位。

## 使用方法

### 1. 启动应用

```bash
npm run serve
```

然后在浏览器中打开 `http://localhost:8080`

### 2. 加载模型

- 选择一个示例项目（如 "car" 或 "luxury_building"）
- 等待模型加载完成

### 3. 添加注释

1. **双击模型部位**：在 3D 场景中双击任意模型部位
2. **配置注释信息**：在弹出的配置弹框中填写以下信息：

   - **标题**（必填）：指示牌的标题
   - **描述**（可选）：详细的说明信息
   - **类型**：选择注释类型
     - 信息 (ℹ️)
     - 警告 (⚠️)
     - 错误 (❌)
     - 成功 (✅)
   - **优先级**：选择优先级级别
     - 低 (绿色)
     - 中 (橙色)
     - 高 (红色)
     - 紧急 (红色)
   - **颜色**：使用颜色选择器自定义指示牌边框颜色

3. **确认创建**：点击"确认"按钮，指示牌将出现在点击位置

### 4. 查看注释

- 指示牌会显示在点击的模型部位上方
- 指示牌会跟随相机视角自动调整位置
- 指示牌包含配置的标题、描述、类型图标和优先级标识

## 技术特性

### 交互功能

- **双击检测**：使用 Three.js 的 Raycaster 进行精确的鼠标点击检测
- **位置计算**：自动计算点击位置的世界坐标
- **实时更新**：指示牌位置会随相机视角实时更新

### 视觉设计

- **原生样式**：使用纯 CSS 实现，无外部依赖
- **响应式布局**：指示牌会根据内容自动调整大小
- **动画效果**：指示牌出现时有淡入动画效果
- **类型区分**：不同类型和优先级有不同的视觉标识

### 数据结构

```typescript
interface AnnotationConfig {
  title: string // 标题
  description: string // 描述
  type: string // 类型：info, warning, error, success
  priority: number // 优先级：1-4
  color: string // 颜色代码
}
```

## 文件结构

```
src/
├── components/
│   └── annotation/
│       ├── AnnotationConfigModal.tsx    # 配置弹框组件
│       ├── AnnotationConfigModal.module.scss
│       ├── AnnotationLabel.tsx          # 指示牌组件
│       └── AnnotationLabel.module.scss
├── core/
│   ├── annotation/
│   │   └── AnnotationManager.ts         # 注释管理器
│   └── Viewer3D.ts                     # 核心3D查看器
└── components/viewer-container/
    └── Viewer3DContainer.tsx           # 3D查看器容器
```

## 扩展功能

### 可能的改进方向

1. **注释管理**：添加注释列表和管理功能
2. **持久化存储**：将注释数据保存到本地或服务器
3. **批量操作**：支持批量创建和删除注释
4. **搜索功能**：根据标题或描述搜索注释
5. **导出功能**：将注释数据导出为报告

### 技术优化

1. **性能优化**：大量注释时的渲染性能优化
2. **内存管理**：及时清理不需要的 DOM 元素
3. **错误处理**：完善异常情况的处理机制

## 注意事项

1. **浏览器兼容性**：确保浏览器支持 ES6+语法
2. **性能考虑**：大量注释可能影响渲染性能
3. **内存使用**：长时间使用注意内存泄漏问题
4. **用户体验**：双击操作需要用户适应

## 故障排除

### 常见问题

1. **双击无响应**：检查模型是否正确加载
2. **指示牌位置错误**：可能是相机视角问题
3. **样式显示异常**：检查 CSS 文件是否正确加载

### 调试方法

1. 打开浏览器开发者工具
2. 查看控制台错误信息
3. 检查网络请求是否正常
4. 验证 Three.js 场景状态
